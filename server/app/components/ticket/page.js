(()=>{var e={};e.id=298,e.ids=[298],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},209:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},8893:e=>{"use strict";e.exports=require("buffer")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8216:e=>{"use strict";e.exports=require("net")},5315:e=>{"use strict";e.exports=require("path")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},2452:e=>{"use strict";e.exports=require("tls")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},9002:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>c,pages:()=>p,routeModule:()=>u,tree:()=>d});var s=r(452),i=r(8530),a=r(3339),n=r.n(a),o=r(6980),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d=["",{children:["components",{children:["ticket",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5866)),"D:\\next\\github\\telegram-starter-working\\app\\components\\ticket\\page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,8483))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,4407)),"D:\\next\\github\\telegram-starter-working\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,8566,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,8483))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],p=["D:\\next\\github\\telegram-starter-working\\app\\components\\ticket\\page.tsx"],c={require:r,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/components/ticket/page",pathname:"/components/ticket",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3417:(e,t,r)=>{Promise.resolve().then(r.bind(r,5866))},6828:(e,t,r)=>{Promise.resolve().then(r.bind(r,6238))},6238:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var s=r(4588),i=r(6091),a=r(5666),n=r(8387),o=r(7668);let l=()=>{let[e,t]=(0,a.useState)("1"),[r,l]=(0,a.useState)(""),[d,p]=(0,a.useState)(""),[c,u]=(0,a.useState)(""),[x,m]=(0,a.useState)(""),[h,g]=(0,a.useState)([]),[f,b]=(0,a.useState)(!1),[y,v]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=document.createElement("script");return e.src="https://telegram.org/js/telegram-web-app.js?2",e.async=!0,document.body.appendChild(e),e.onload=async()=>{let e=window.Telegram;if(e.WebApp.expand(),window.Telegram&&window.Telegram.WebApp){window.Telegram.WebApp.ready();let{user:t}=e.WebApp.initDataUnsafe;t&&t.id&&v(t.id.toString())}},()=>{document.body.removeChild(e)}},[]),(0,a.useEffect)(()=>{let e=async()=>{let{data:e,error:t}=await n.O.from("ticket").select("*").order("time",{ascending:!1});t?console.error("Error fetching tickets:",t):g(e)};e();let t=n.O.channel("realtime:ticket").on("postgres_changes",{event:"*",schema:"public",table:"ticket",filter:`uid=eq.${y}`},t=>{console.log("Realtime event received:",t),e()}).subscribe(e=>{console.log("Subscription status:",e)});return()=>{n.O.removeChannel(t)}},[]);let j=async()=>{let t={subject:"1"===e?r:null,action:"2"===e?d:null,orderId:"2"===e?c:null,message:"1"===e?x:null,optionType:e,uid:y},{error:s}=await n.O.from("ticket").insert([t]);s?(console.error("Error submitting ticket:",s),alert("Failed to submit ticket. Please try again.")):(o.Z.fire({icon:"success",title:"Success",text:"Ticket submitted successfully!"}),g(e=>[...e,t]),b(!1))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i.aV,{style:{padding:"5px",height:"40rem",position:"relative"},children:[(0,s.jsx)(i.zx,{color:"primary",style:{width:"100%",margin:"1rem auto 0 auto",borderRadius:"0.5rem",padding:"0.5rem 1rem",fontSize:"1rem"},onClick:()=>b(!0),children:"Open Ticket Form"}),(0,s.jsx)(i.$0,{style:{marginTop:"1rem",border:"1px solid var(--tgui--section_bg_color)"},children:(0,s.jsxs)("div",{style:{borderRadius:"10px",height:"31rem",width:"100%"},className:"scrollabler  w-full overflow-x-auto",children:[(0,s.jsx)(i.xv,{header:"Submitted Tickets"}),(0,s.jsxs)("table",{className:"min-w-full rounded-lg shadow-md",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Type"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Subject"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Action"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-nowrap tracking-wider",children:"Order ID"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Date"})]})}),(0,s.jsx)("tbody",{children:h.map((e,t)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-6 py-4 text-sm",style:{textShadow:"done"===e.status?"2px 2px 29px lime":"Pending"===e.status?"2px 2px 29px yellow":void 0},children:e.status||"-"}),(0,s.jsx)("td",{className:"px-6 py-4 text-sm",children:e.optionType}),(0,s.jsx)("td",{className:"px-6 py-4 text-sm",children:e.subject||"-"}),(0,s.jsx)("td",{className:"px-6 py-4 text-sm",children:e.action||"-"}),(0,s.jsx)("td",{className:"px-6 py-4 text-sm",children:e.orderId||"-"}),(0,s.jsx)("td",{className:"px-6 py-4 text-sm text-nowrap",children:e.created_at||"-"})]},t))})]})]})})]}),f&&(0,s.jsxs)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3,display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,s.jsx)("button",{style:{position:"absolute",top:"10px",right:"10px",background:"transparent",border:"none",fontSize:"4rem",cursor:"pointer",color:"white"},onClick:()=>b(!1),children:"\xd7"}),(0,s.jsxs)(i.$0,{style:{backgroundColor:"white",padding:"1rem",borderRadius:"0.5rem",border:"1px solid var(--tgui--section_bg_color)",width:"90%",maxWidth:"500px"},children:[(0,s.jsxs)(i.Ph,{header:"Support Type",onChange:e=>t(e.target.value),children:[(0,s.jsx)("option",{value:"1",children:"Human Support"}),(0,s.jsx)("option",{value:"2",children:"AI Support"})]}),"2"===e&&(0,s.jsxs)(i.Ph,{header:"Action",value:d,onChange:e=>p(e.target.value),children:[(0,s.jsx)("option",{value:"cancel",children:"Cancel"}),(0,s.jsx)("option",{value:"speed",children:"Speed"}),(0,s.jsx)("option",{value:"refil",children:"Refil"})]}),"1"===e&&(0,s.jsx)(i.II,{header:"Subject",value:r,onChange:e=>l(e.target.value)}),"2"===e&&(0,s.jsx)(i.II,{header:"Order IDs",value:c,onChange:e=>u(e.target.value)}),"1"===e&&(0,s.jsx)("textarea",{placeholder:"Type message",rows:"10",style:{margin:"10px",padding:"10px",width:"90%",border:"3px solid darkblue",borderRadius:"7px"},value:x,onChange:e=>m(e.target.value)}),(0,s.jsx)(i.zx,{color:"primary  ml-auto",style:{width:"100%",margin:"1rem auto 0 auto",borderRadius:"0.5rem",padding:"0.5rem 1rem",fontSize:"1rem"},onClick:j,children:"Send"})]})]})]})}},5866:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(9102).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\next\\\\github\\\\telegram-starter-working\\\\app\\\\components\\\\ticket\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\next\\github\\telegram-starter-working\\app\\components\\ticket\\page.tsx","default")},8483:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(6121);let i=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[872,487,121,668,876],()=>r(9002));module.exports=s})();