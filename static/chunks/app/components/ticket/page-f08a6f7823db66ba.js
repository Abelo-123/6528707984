(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[298],{1714:(e,t,s)=>{Promise.resolve().then(s.bind(s,286))},286:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(4650),i=s(9972),a=s(3064),l=s(8370),n=s(7420),d=s.n(n);let o=()=>{let[e,t]=(0,a.useState)("1"),[s,n]=(0,a.useState)(""),[o,c]=(0,a.useState)(""),[p,x]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[h,g]=(0,a.useState)([]),[j,b]=(0,a.useState)(!1),[y,f]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=document.createElement("script");return e.src="https://telegram.org/js/telegram-web-app.js?2",e.async=!0,document.body.appendChild(e),e.onload=async()=>{let e=window.Telegram;if(e.WebApp.expand(),window.Telegram&&window.Telegram.WebApp){window.Telegram.WebApp.ready();let{user:t}=e.WebApp.initDataUnsafe;t&&t.id&&f(t.id.toString())}},()=>{document.body.removeChild(e)}},[]),(0,a.useEffect)(()=>{let e=async()=>{let{data:e,error:t}=await l.O.from("ticket").select("*").order("time",{ascending:!1});t?console.error("Error fetching tickets:",t):g(e)};e();let t=l.O.channel("realtime:ticket").on("postgres_changes",{event:"*",schema:"public",table:"ticket",filter:"uid=eq.".concat(y)},t=>{console.log("Realtime event received:",t),e()}).subscribe(e=>{console.log("Subscription status:",e)});return()=>{l.O.removeChannel(t)}},[]);let w=async()=>{let t={subject:"1"===e?s:null,action:"2"===e?o:null,orderId:"2"===e?p:null,message:"1"===e?u:null,optionType:e,uid:y},{error:r}=await l.O.from("ticket").insert([t]);r?(console.error("Error submitting ticket:",r),alert("Failed to submit ticket. Please try again.")):(d().fire({icon:"success",title:"Success",text:"Ticket submitted successfully!"}),g(e=>[...e,t]),b(!1))};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.aV,{style:{padding:"5px",height:"40rem",position:"relative"},children:[(0,r.jsx)(i.zx,{color:"primary",style:{width:"100%",margin:"1rem auto 0 auto",borderRadius:"0.5rem",padding:"0.5rem 1rem",fontSize:"1rem"},onClick:()=>b(!0),children:"Open Ticket Form"}),(0,r.jsx)(i.$0,{style:{marginTop:"1rem",border:"1px solid var(--tgui--section_bg_color)"},children:(0,r.jsxs)("div",{style:{borderRadius:"10px",height:"31rem",width:"100%"},className:"scrollabler  w-full overflow-x-auto",children:[(0,r.jsx)(i.xv,{header:"Submitted Tickets"}),(0,r.jsxs)("table",{className:"min-w-full rounded-lg shadow-md",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Type"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Subject"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Action"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-nowrap tracking-wider",children:"Order ID"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",children:"Date"})]})}),(0,r.jsx)("tbody",{children:h.map((e,t)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-6 py-4 text-sm",style:{textShadow:"done"===e.status?"2px 2px 29px lime":"Pending"===e.status?"2px 2px 29px yellow":void 0},children:e.status||"-"}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm",children:e.optionType}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm",children:e.subject||"-"}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm",children:e.action||"-"}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm",children:e.orderId||"-"}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-nowrap",children:e.created_at||"-"})]},t))})]})]})})]}),j&&(0,r.jsxs)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3,display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,r.jsx)("button",{style:{position:"absolute",top:"10px",right:"10px",background:"transparent",border:"none",fontSize:"4rem",cursor:"pointer",color:"white"},onClick:()=>b(!1),children:"\xd7"}),(0,r.jsxs)(i.$0,{style:{backgroundColor:"white",padding:"1rem",borderRadius:"0.5rem",border:"1px solid var(--tgui--section_bg_color)",width:"90%",maxWidth:"500px"},children:[(0,r.jsxs)(i.Ph,{header:"Support Type",onChange:e=>t(e.target.value),children:[(0,r.jsx)("option",{value:"1",children:"Human Support"}),(0,r.jsx)("option",{value:"2",children:"AI Support"})]}),"2"===e&&(0,r.jsxs)(i.Ph,{header:"Action",value:o,onChange:e=>c(e.target.value),children:[(0,r.jsx)("option",{value:"cancel",children:"Cancel"}),(0,r.jsx)("option",{value:"speed",children:"Speed"}),(0,r.jsx)("option",{value:"refil",children:"Refil"})]}),"1"===e&&(0,r.jsx)(i.II,{header:"Subject",value:s,onChange:e=>n(e.target.value)}),"2"===e&&(0,r.jsx)(i.II,{header:"Order IDs",value:p,onChange:e=>x(e.target.value)}),"1"===e&&(0,r.jsx)("textarea",{placeholder:"Type message",rows:"10",style:{margin:"10px",padding:"10px",width:"90%",border:"3px solid darkblue",borderRadius:"7px"},value:u,onChange:e=>m(e.target.value)}),(0,r.jsx)(i.zx,{color:"primary  ml-auto",style:{width:"100%",margin:"1rem auto 0 auto",borderRadius:"0.5rem",padding:"0.5rem 1rem",fontSize:"1rem"},onClick:w,children:"Send"})]})]})]})}},8370:(e,t,s)=>{"use strict";s.d(t,{O:()=>r});let r=(0,s(3070).eI)("https://bihqharjyezzxhsghell.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJpaHFoYXJqeWV6enhoc2doZWxsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjU5NzM0MjMsImV4cCI6MjA0MTU0OTQyM30.7W7Vpd7fol3UWLUFLqUiHty2hdTrD-H3-4LT78wveFk")}},e=>{var t=t=>e(e.s=t);e.O(0,[934,972,70,947,170,744],()=>t(1714)),_N_E=e.O()}]);